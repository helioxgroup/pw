<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="A secure, cryptographically strong password generator with bulk export capabilities. Generate passwords offline with modern web standards.">
    <meta name="theme-color" content="#022742">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Apple iOS PWA Support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="PW Generator">
    <link rel="apple-touch-icon" href="icons/ios/152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/ios/180.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="icons/ios/32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/ios/16.png">
    
    <!-- Font preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Inline SVG icons instead of full Font Awesome library -->
    <style>
        .icon-svg { width: 1em; height: 1em; fill: currentColor; vertical-align: -0.125em; }
    </style>
    <link rel="stylesheet" href="style.css" />
    <title>Password Generator by Edward Jaeger</title>
</head>

<body>
    <div class="container">
        <header class="header">
            <h1>Password Generator</h1>
        </header>

        <div class="password-display">
            <div class="password-wrapper">
                <span id="result" aria-live="polite" aria-label="Generated password">Generating...</span>
            </div>
            <button class="btn-icon" id="clipboard" aria-label="Copy password to clipboard" title="Copy to clipboard">
                <svg class="icon-svg" id="clipboardIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" aria-hidden="true"><path d="M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zm-6 400H54a6 6 0 0 1-6-6V118a6 6 0 0 1 6-6h42v36c0 6.6 5.4 12 12 12h168c6.6 0 12-5.4 12-12v-36h42a6 6 0 0 1 6 6v340a6 6 0 0 1-6 6zM192 40c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24z"/></svg>
            </button>
        </div>

        <div id="notification" class="notification" role="alert" aria-live="polite"></div>

        <div class="settings-card">
            <div class="setting-group">
                <label for="length" class="setting-label">
                    <span>Password Length</span>
                    <span class="length-value" id="lengthValue">18</span>
                </label>
                <input type="range" id="length" min="6" max="32" value="18" class="slider"
                    aria-describedby="length-hint">
            </div>

            <div class="divider"></div>

            <div class="setting-group">
                <label for="uppercase" class="checkbox-label">
                    <input type="checkbox" id="uppercase" checked>
                    <span class="checkbox-custom"></span>
                    <span class="checkbox-text">Uppercase Letters (A-Z)</span>
                </label>
            </div>

            <div class="setting-group">
                <label for="lowercase" class="checkbox-label">
                    <input type="checkbox" id="lowercase" checked>
                    <span class="checkbox-custom"></span>
                    <span class="checkbox-text">Lowercase Letters (a-z)</span>
                </label>
            </div>

            <div class="setting-group">
                <label for="numbers" class="checkbox-label">
                    <input type="checkbox" id="numbers" checked>
                    <span class="checkbox-custom"></span>
                    <span class="checkbox-text">Numbers (0-9)</span>
                </label>
            </div>

            <div class="setting-group">
                <label for="symbols" class="checkbox-label">
                    <input type="checkbox" id="symbols" checked>
                    <span class="checkbox-custom"></span>
                    <span class="checkbox-text">Symbols (!@#$%^&*)</span>
                </label>
            </div>
        </div>

        <button class="btn-generate" id="generate">
            <svg class="icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" aria-hidden="true"><path d="M512 176.001C512 273.203 433.202 352 336 352c-11.22 0-22.19-1.062-32.827-3.069l-24.012 27.014A23.999 23.999 0 0 1 261.223 384H224v40c0 13.255-10.745 24-24 24h-40v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24v-78.059c0-6.365 2.529-12.47 7.029-16.971l161.802-161.802C163.108 213.814 160 195.199 160 176.001 160 78.798 238.798 0 336 0s176 78.798 176 176.001zM336 128c0 26.51 21.49 48 48 48s48-21.49 48-48-21.49-48-48-48-48 21.49-48 48z"/></svg>
            <span>Generate Password</span>
        </button>

        <div class="bulk-export-section">
            <div class="bulk-header" id="bulkToggle">
                <svg class="icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" aria-hidden="true"><path d="M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"/></svg>
                <span>Bulk Export to CSV</span>
                <svg class="icon-svg toggle-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" aria-hidden="true"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
            </div>
            <div class="bulk-content" id="bulkContent">
                <div class="bulk-input-group">
                    <label for="bulkCount">Number of passwords:</label>
                    <input type="number" id="bulkCount" min="1" max="500" value="10" class="bulk-input">
                </div>
                <button class="btn-export" id="exportCsv">
                    <svg class="icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" aria-hidden="true"><path d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm-96 144c0 4.42-3.58 8-8 8h-8c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h8c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8h-8c-26.51 0-48-21.49-48-48v-32c0-26.51 21.49-48 48-48h8c4.42 0 8 3.58 8 8v16zm44.27 104H160c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h12.27c5.95 0 10.41-3.5 10.41-6.62 0-1.3-.75-2.66-2.12-3.84l-21.89-18.77c-8.47-7.22-13.33-17.48-13.33-28.14 0-21.3 19.02-38.62 42.41-38.62H200c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8h-12.27c-5.95 0-10.41 3.5-10.41 6.62 0 1.3.75 2.66 2.12 3.84l21.89 18.77c8.47 7.22 13.33 17.48 13.33 28.14.01 21.3-19 38.62-42.39 38.62zM256 264v20.8c0 20.27 5.7 40.17 16 56.88 10.3-16.7 16-36.61 16-56.88V264c0-4.42 3.58-8 8-8h16c4.42 0 8 3.58 8 8v20.8c0 35.48-12.88 68.89-36.28 94.09-3.02 3.25-7.27 5.11-11.72 5.11s-8.7-1.86-11.72-5.11c-23.4-25.2-36.28-58.61-36.28-94.09V264c0-4.42 3.58-8 8-8h16c4.42 0 8 3.58 8 8zm121-159L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"/></svg>
                    <span>Export CSV</span>
                </button>
            </div>
        </div>

        <footer class="footer">
            <p>Made with <span class="heart">â™¥</span> by <a href="https://birthbaum.com"
                    target="_blank" rel="noopener noreferrer">Edward Jaeger</a></p>
        </footer>
    </div>

    <script src="script.js"></script>
    
    <!-- Service Worker Registration with Auto-Update -->
    <script>
        if ('serviceWorker' in navigator) {
            let refreshing = false;
            
            // Detect controller change and reload page
            navigator.serviceWorker.addEventListener('controllerchange', () => {
                if (!refreshing) {
                    refreshing = true;
                    window.location.reload();
                }
            });
            
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => {
                        console.log('Service Worker registered successfully:', registration.scope);
                        
                        // Check for updates every 60 seconds while app is open
                        setInterval(() => {
                            registration.update();
                        }, 60000);
                        
                        // Check for updates when app becomes visible
                        document.addEventListener('visibilitychange', () => {
                            if (!document.hidden) {
                                registration.update();
                            }
                        });
                        
                        // Listen for waiting service worker
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New service worker available, tell it to take over
                                    newWorker.postMessage({ type: 'SKIP_WAITING' });
                                }
                            });
                        });
                    })
                    .catch(error => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>

</html>
