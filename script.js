const resultEl=document.getElementById('result'),lengthEl=document.getElementById('length'),lengthValueEl=document.getElementById('lengthValue'),uppercaseEl=document.getElementById('uppercase'),lowercaseEl=document.getElementById('lowercase'),numbersEl=document.getElementById('numbers'),symbolsEl=document.getElementById('symbols'),generateEl=document.getElementById('generate'),clipboardEl=document.getElementById('clipboard'),notificationEl=document.getElementById('notification'),bulkToggleEl=document.getElementById('bulkToggle'),bulkContentEl=document.getElementById('bulkContent'),bulkCountEl=document.getElementById('bulkCount'),exportCsvEl=document.getElementById('exportCsv');bulkToggleEl.addEventListener('click',()=>{bulkToggleEl.classList.toggle('active');bulkContentEl.classList.toggle('show')});exportCsvEl.addEventListener('click',()=>{const count=parseInt(bulkCountEl.value);if(isNaN(count)||count<1||count>500){showNotification('Please enter a number between 1 and 500!','error');return}const length=+lengthEl.value,hasLower=lowercaseEl.checked,hasUpper=uppercaseEl.checked,hasNumber=numbersEl.checked,hasSymbol=symbolsEl.checked;if(!hasLower&&!hasUpper&&!hasNumber&&!hasSymbol){showNotification('Please select at least one character type!','error');return}const passwords=[];for(let i=0;i<count;i++){passwords.push(createPassword(hasLower,hasUpper,hasNumber,hasSymbol,length))}const csvContent=generateCSV(passwords,length,hasLower,hasUpper,hasNumber,hasSymbol);downloadCSV(csvContent,`passwords_${count}_${new Date().toISOString().split('T')[0]}.csv`);showNotification(`Successfully exported ${count} passwords!`,'success')});function generateCSV(passwords,length,hasLower,hasUpper,hasNumber,hasSymbol){let csv='Password,Length,Character Types,Generated Date\n';const types=[];if(hasLower)types.push('Lowercase');if(hasUpper)types.push('Uppercase');if(hasNumber)types.push('Numbers');if(hasSymbol)types.push('Symbols');const typesStr=types.join(' + '),now=new Date().toLocaleString();passwords.forEach(password=>{const escaped=password.replace(/"/g,'""');csv+=`"${escaped}",${length},"${typesStr}","${now}"\n`});return csv}function downloadCSV(content,filename){const blob=new Blob([content],{type:'text/csv;charset=utf-8;'}),link=document.createElement('a');link.href=URL.createObjectURL(blob);link.download=filename;link.style.display='none';document.body.appendChild(link);link.click();document.body.removeChild(link);URL.revokeObjectURL(link.href)}lengthEl.addEventListener('input',()=>{lengthValueEl.textContent=lengthEl.value;generatePassword()});window.addEventListener('DOMContentLoaded',()=>{generatePassword()});clipboardEl.addEventListener('click',async()=>{const password=resultEl.innerText;if(!password||password==='Generating...'){showNotification('No password to copy!','error');return}try{await navigator.clipboard.writeText(password);showNotification('Password copied to clipboard!','success');const icon=clipboardEl.querySelector('svg'),originalPath=icon.innerHTML;icon.setAttribute('viewBox','0 0 512 512');icon.innerHTML='<path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"/>';setTimeout(()=>{icon.setAttribute('viewBox','0 0 384 512');icon.innerHTML=originalPath},2000)}catch(err){fallbackCopyToClipboard(password)}});function fallbackCopyToClipboard(text){const textarea=document.createElement('textarea');textarea.value=text;textarea.style.position='fixed';textarea.style.opacity='0';document.body.appendChild(textarea);textarea.select();try{document.execCommand('copy');showNotification('Password copied to clipboard!','success')}catch(err){showNotification('Failed to copy password','error')}document.body.removeChild(textarea)}function showNotification(message,type='success'){notificationEl.textContent=message;notificationEl.className=`notification ${type} show`;setTimeout(()=>{notificationEl.classList.remove('show')},3000)}generateEl.addEventListener('click',generatePassword);uppercaseEl.addEventListener('change',generatePassword);lowercaseEl.addEventListener('change',generatePassword);numbersEl.addEventListener('change',generatePassword);symbolsEl.addEventListener('change',generatePassword);document.querySelectorAll('input[type="checkbox"]').forEach(checkbox=>{checkbox.addEventListener('keypress',e=>{if(e.key==='Enter')generatePassword()})});function generatePassword(){const length=+lengthEl.value,hasLower=lowercaseEl.checked,hasUpper=uppercaseEl.checked,hasNumber=numbersEl.checked,hasSymbol=symbolsEl.checked;if(!hasLower&&!hasUpper&&!hasNumber&&!hasSymbol){showNotification('Please select at least one character type!','error');resultEl.innerText='';return}if(length<6||length>32){showNotification('Password length must be between 6 and 32!','error');return}const password=createPassword(hasLower,hasUpper,hasNumber,hasSymbol,length);resultEl.style.opacity='0';setTimeout(()=>{resultEl.innerText=password;resultEl.style.opacity='1'},150)}function createPassword(lower,upper,number,symbol,length){let chars='';if(lower)chars+='abcdefghijklmnopqrstuvwxyz';if(upper)chars+='ABCDEFGHIJKLMNOPQRSTUVWXYZ';if(number)chars+='0123456789';if(symbol)chars+='!@#$%^&*(){}[]=<>/,.';const required=[];if(lower)required.push(getRandomLower());if(upper)required.push(getRandomUpper());if(number)required.push(getRandomNumber());if(symbol)required.push(getRandomSymbol());const remaining=length-required.length,randomBuffer=new Uint32Array(remaining);crypto.getRandomValues(randomBuffer);const fillChars=[];for(let i=0;i<remaining;i++){const limit=Math.floor(4294967296/chars.length)*chars.length;let val=randomBuffer[i];while(val>=limit){const singleBuf=new Uint32Array(1);crypto.getRandomValues(singleBuf);val=singleBuf[0]}fillChars.push(chars[val%chars.length])}return shuffleString(required.concat(fillChars).join(''))}function shuffleString(str){const arr=str.split('');for(let i=arr.length-1;i>0;i--){const j=getSecureRandomInt(i+1);[arr[i],arr[j]]=[arr[j],arr[i]]}return arr.join('')}function getSecureRandomInt(max){const randomBuffer=new Uint32Array(1),limit=Math.floor(4294967296/max)*max;do{crypto.getRandomValues(randomBuffer)}while(randomBuffer[0]>=limit);return randomBuffer[0]%max}function getRandomLower(){return String.fromCharCode(getSecureRandomInt(26)+97)}function getRandomUpper(){return String.fromCharCode(getSecureRandomInt(26)+65)}function getRandomNumber(){return String.fromCharCode(getSecureRandomInt(10)+48)}function getRandomSymbol(){const symbols='!@#$%^&*(){}[]=<>/,.';return symbols[getSecureRandomInt(symbols.length)]}resultEl.style.transition='opacity 0.15s ease';
